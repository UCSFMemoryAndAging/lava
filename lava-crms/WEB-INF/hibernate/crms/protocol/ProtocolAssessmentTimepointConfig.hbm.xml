<?xml version="1.0"?> 

<!DOCTYPE hibernate-mapping PUBLIC 
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
     
<hibernate-mapping>

<joined-subclass name="edu.ucsf.lava.crms.protocol.model.ProtocolAssessmentTimepointConfig" table="prot_assess_tp_config" extends="edu.ucsf.lava.crms.protocol.model.ProtocolTimepointConfig" select-before-update="true">
	<key column="node_id"/> 
	<many-to-one name="collectWinAnchorVisit" column="collect_win_anchor_visit_id" class="edu.ucsf.lava.crms.protocol.model.ProtocolVisitConfigBase" lazy="false"/>
	<property name="collectWinSize" column="collect_win_size" type="short"/>
	<property name="collectWinOffset" column="collect_win_offset" type="short"/>
	<property name="collectWinStatus" column="collect_win_status" type="string" length="25"/>
</joined-subclass>

	<query name="list.protocol.collectWinAnchorVisit"><![CDATA[
	   SELECT new edu.ucsf.lava.core.list.model.LabelValueBean(visitConfig.label, visitConfig.id)
			from edu.ucsf.lava.crms.protocol.model.ProtocolVisitConfigBase as visitConfig
			where visitConfig.timepointConfigBase.id = :timepointConfigId
	]]></query>	

</hibernate-mapping>
