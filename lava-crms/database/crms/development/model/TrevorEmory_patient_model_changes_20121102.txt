Trevor 

applied 11/2/12

questions:
- do update scripts handle middleInitial ==> middleName
  YES
- is middleInitial backwards compatible
  NO. Once code is updated it everything that used middleInitial must change to use middleName
- do update scripts handle ==> deathMonth/deathDay/deathYear
  YES
- for existing apps (demo / smd / msc) will UI pull deathDate out correctly
  NO, once code updated, database update scripts need to be run, and there will
  no longer be a deathDate field (i.e. a persisted field. there will still be a 
  deathDate property which is calculated for potential use in filters, etc. (note
  that Trevor put the calculation as a Hibernate formula rather than in Java using
  the afterCreate/afterUpdate hooks. not sure if his Hibernate formula is portable
  across databases)

IF update scripts handle conversions then no need to alert Marco, although should
tell him in case he has a) middle names as strings and b) death dates with parts missing

NOTE: 
mac uses middleInitial and deathDate
smd uses middleInitial and deathDate
msc looks like does not use middleInitial and does not use deathDate


lava-core
=========

core/dto/PagedListItemDto.java
added getters to allow auditing of entities accessed thru list DTO:
getAuditParentEntityName
getAuditParentEntityType
	
core/audit/AuditManager.java
1) added auditEntityFromListItemDto method to allow auditing an entity thru a list DTO



lava-crms
==========

database/crms/development/data/lava-crms-data-3.2.0-to-3.3.0.sql
database/crms/development/model/lava-crms-model-3.2.0-to-3.3.0.sql

AddPatientHandler.java
1) middleInitial ==> middleName
2) enterBy ==> createdBy
3) new created property set

AddPatientLookupHandler.java
1) removed import:
import edu.ucsf.lava.core.dao.hibernate.DaoHibernateNamedParam;

PatientHandler.java
deathDate broken into:
deathMonth
deathDay
deathYear
1) doSave checks deathDate for invalid date, yet accepts dates with unknown parts 
2) new modifiedBy property set


people/dto/FindPatientListItemDto.java
protocol/dto/StatusListItemDto.java
added getters to allow auditing of entities accessed thru list DTO:
getAuditParentEntityName
getAuditParentEntityType


Caregiver.java
Caregiver.hbm.xml
caregiverContent.jsp
1) added title property


Patient.java
1) Character middleInitial ==> String middleName
   getMiddleInitial method modified to return middleInitial for backward compatibility
2) added title property
3) setDeidentified modified accordingly for above 2 changes
4) added deathMonth, deathDay, deathYear properties (deathDate no longer persisted)
   note: getters set dirty flag for recalculating age in afterUpdate
5) getDeathDate method calculates from parts
6) enterBy ==> createdBy
7) added created property
8) added modifiedBy property
   note: existing modified property used
9) added getCaregivers method to retrieve the list of Caregivers

Patient.hbm.xml
1) middleInitial character ==> middleName varchar 25
2) added title
3) added deathMonth, deathDay, deathYear (getAge method modified accordingly
4) added calculated deathDate property for use by filters
5) enterBy ==> createdBy
6) added created
7) added modifiedBy

addPatientContent.jsp
1) middleInitial ==> middleName

patientContent.jsp
1) added title
2) middleInitial ==> middleName

crms-messages.properties
1) added Death Date messages


lists/lists-people.xml
1) deathMonth/Day/Year lists
2) generic.nameTitle list for new title property (Patient, Caregiver)


  

lava-crms-nacc
==============
NaccPathology.java
deathDate broken up into month, day, year
npDod ==> 
npdodmo
npdoddy
npdodyr

note: npDod retained for now even though full death date may not be known





